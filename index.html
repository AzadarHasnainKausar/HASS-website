<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Management System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }
        h1 {
            text-align: center;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-section {
            display: none;
            margin-top: 20px;
        }
        .form-section.active {
            display: block;
        }
        label {
            display: block;
            margin: 10px 0 5px;
        }
        input, select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
        }
        button {
            padding: 10px;
            background-color: #5cb85c;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #4cae4c;
        }
        #fee-check-result {
            margin-top: 10px;
            padding: 10px;
            background-color: #e7f3fe;
            border-left: 6px solid #2196F3;
        }
    </style>
</head>
<body>
    <h1>School Management System</h1>
    <div class="container">
        <div>
            <button onclick="showSection('admission')">Admission Panel</button>
            <button onclick="showSection('feeSubmission')">Fee Submission</button>
            <button onclick="showSection('feeChecking')">Fee Checking</button>
            <button onclick="showSection('submittedFeeDetails')">Submitted Fee Details</button>
        </div>

        <div id="admission" class="form-section active">
            <h2>Admission Form</h2>
            <form id="admission-form" onsubmit="saveAdmissionData(); return false;">
                <label for="registration-number">Registration Number</label>
                <input type="text" id="registration-number" required>
                <label for="student-name">Student Name</label>
                <input type="text" id="student-name" required>
                <label for="dob">Date of Birth</label>
                <input type="date" id="dob" required>
                <label for="student-cnic">Student CNIC</label>
                <input type="text" id="student-cnic" required>
                <label for="fathers-name">Father's Name</label>
                <input type="text" id="fathers-name" required>
                <label for="fathers-cnic">Father's CNIC</label>
                <input type="text" id="fathers-cnic" required>
                <label for="cast">Cast</label>
                <input type="text" id="cast" required>
                <label for="fathers-occupation">Father's Occupation</label>
                <input type="text" id="fathers-occupation" required>
                <label for="admitted-class">Admitted In Class</label>
                <input type="text" id="admitted-class" required>
                <label for="address">Address</label>
                <input type="text" id="address" required>
                <button type="submit">Submit Admission</button>
            </form>
        </div>

        <div id="feeSubmission" class="form-section">
            <h2>Fee Submission</h2>
            <form id="fee-submission-form" onsubmit="saveFeeData(); return false;">
                <label for="fee-student-name">Student Name</label>
                <input type="text" id="fee-student-name" required>
                <label for="fee-fathers-name">Father's Name</label>
                <input type="text" id="fee-fathers-name" required>
                <label for="fee-grade">Select Grade</label>
                <input type="text" id="fee-grade" required>
                <label for="fee-amount">Fee Amount</label>
                <input type="number" id="fee-amount" required>
                <button type="submit">Submit Fee</button>
            </form>
        </div>

        <div id="feeChecking" class="form-section">
            <h2>Check Fee by FRN</h2>
            <form onsubmit="checkFee(); return false;">
                <label for="check-frn">Enter FRN</label>
                <input type="text" id="check-frn" required>
                <button type="submit">Check Fee</button>
            </form>
            <div id="fee-check-result"></div>
        </div>

        <div id="submittedFeeDetails" class="form-section">
            <h2>Submitted Fee Details</h2>
            <div id="submitted-fee-list"></div>
        </div>
    </div>

    <script>
        function showSection(section) {
            const sections = document.querySelectorAll('.form-section');
            sections.forEach(s => s.classList.remove('active'));
            document.getElementById(section).classList.add('active');
            if (section === 'submittedFeeDetails') {
                loadSubmittedFeeDetails();
            }
        }

        function saveAdmissionData() {
            const admissionData = {
                registrationNumber: document.getElementById('registration-number').value,
                studentName: document.getElementById('student-name').value,
                dob: document.getElementById('dob').value,
                studentCnic: document.getElementById('student-cnic').value,
                fathersName: document.getElementById('fathers-name').value,
                fathersCnic: document.getElementById('fathers-cnic').value,
                cast: document.getElementById('cast').value,
                fathersOccupation: document.getElementById('fathers-occupation').value,
                admittedClass: document.getElementById('admitted-class').value,
                address: document.getElementById('address').value,
            };

            const classFolder = admissionData.admittedClass; // Use admitted class as folder name
            const admissions = JSON.parse(localStorage.getItem(classFolder)) || [];
            admissions.push(admissionData);
            localStorage.setItem(classFolder, JSON.stringify(admissions));

            alert('Admission data saved successfully!');
            document.getElementById('admission-form').reset(); // Reset form
        }

        function saveFeeData() {
            const feeData = {
                studentName: document.getElementById('fee-student-name').value,
                fathersName: document.getElementById('fee-fathers-name').value,
                grade: document.getElementById('fee-grade').value,
                feeAmount: document.getElementById('fee-amount').value,
                frn: Math.random().toString(36).substring(2, 15) // Generate random FRN
            };

            const classFolder = feeData.grade; // Use grade as folder name
            const fees = JSON.parse(localStorage.getItem(classFolder + '-fees')) || [];
            fees.push(feeData);
            localStorage.setItem(classFolder + '-fees', JSON.stringify(fees));

            alert('Fee data saved successfully! Your FRN is: ' + feeData.frn);
            document.getElementById('fee-submission-form').reset(); // Reset form
        }

        function checkFee() {
            const frn = document.getElementById('check-frn').value;

            // Check all fee records for the entered FRN
            let found = false;
            const feeKeys = Object.keys(localStorage);
            feeKeys.forEach(key => {
                if (key.endsWith('-fees')) {
                    const fees = JSON.parse(localStorage.getItem(key));
                    const result = fees.find(fee => fee.frn === frn);
                    if (result) {
                        const resultDiv = document.getElementById('fee-check-result');
                        resultDiv.innerHTML = `Fee Amount: ${result.feeAmount} <br> Student Name: ${result.studentName} <br> Father's Name: ${result.fathersName}`;
                        found = true;
                    }
                }
            });
            if (!found) {
                document.getElementById('fee-check-result').innerHTML = 'No fee records found for this FRN.';
            }
        }

        function loadSubmittedFeeDetails() {
            const submittedFeeList = document.getElementById('submitted-fee-list');
            submittedFeeList.innerHTML = ''; // Clear previous results

            const feeKeys = Object.keys(localStorage);
            feeKeys.forEach(key => {
                if (key.endsWith('-fees')) {
                    const fees = JSON.parse(localStorage.getItem(key));
                    fees.forEach(fee => {
                        const feeDetail = document.createElement('div');
                        feeDetail.innerHTML = `FRN: ${fee.frn}, Student Name: ${fee.studentName}, Father's Name: ${fee.fathersName}, Fee Amount: ${fee.feeAmount}, Grade: ${key.replace('-fees', '')}`;
                        submittedFeeList.appendChild(feeDetail);
                    });
                }
            });
        }
    </script>
</body>
</html>
